2022-04-06 13:46:33,529 INFO     [run_moose.py:53] ****************************************************************************************************
2022-04-06 13:46:33,529 INFO     [run_moose.py:54]                                      STARTING MOOSE V.1.0                                           
2022-04-06 13:46:33,529 INFO     [run_moose.py:55] ****************************************************************************************************
2022-04-06 13:46:33,529 INFO     [run_moose.py:58]  
2022-04-06 13:46:33,529 INFO     [run_moose.py:59] INPUT ARGUMENTS
2022-04-06 13:46:33,529 INFO     [run_moose.py:60] ------------------
2022-04-06 13:46:33,530 INFO     [run_moose.py:61] - Main folder: /home/kyloren/Documents/Projects/MOOSE/Test/
2022-04-06 13:46:33,530 INFO     [run_moose.py:62] - Error analysis: True[1 = True, 0 = False]
2022-04-06 13:46:33,530 INFO     [run_moose.py:63] - Total number of subjects to MOOSE: 2
2022-04-06 13:46:33,530 INFO     [run_moose.py:64]  
2022-04-06 13:46:33,530 INFO     [run_moose.py:71] :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2022-04-06 13:46:33,530 INFO     [run_moose.py:72] - Working folder: /home/kyloren/Documents/Projects/MOOSE/Test/10002
2022-04-06 13:46:33,530 INFO     [run_moose.py:74] - Processing subject:  10002
2022-04-06 13:46:33,530 INFO     [run_moose.py:76] - Number of folders in subject 10002: 2
2022-04-06 13:46:33,530 INFO     [run_moose.py:77] - Folder names: ['/home/kyloren/Documents/Projects/MOOSE/Test/10002/AC_CT_1.2.752.37.47.345051852996.20220302.28966.5.426173', '/home/kyloren/Documents/Projects/MOOSE/Test/10002/PET_WB_CORRECTED_1.2.752.37.47.345051852996.20220302.28966.5.426167']
2022-04-06 13:46:33,530 INFO     [run_moose.py:78] :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2022-04-06 13:46:33,530 INFO     [run_moose.py:79]  
2022-04-06 13:46:33,530 INFO     [imageIO.py:95] Converting DICOM images in /home/kyloren/Documents/Projects/MOOSE/Test/10002 to NIFTI
2022-04-06 13:46:34,094 INFO     [imageIO.py:100] Conversion from DICOM to NIFTI done
2022-04-06 13:46:34,096 INFO     [run_moose.py:87] Looking for modality type and organising the files accordingly
2022-04-06 13:46:34,096 INFO     [run_moose.py:122] Both PET and CT data found in folder /home/kyloren/Documents/Projects/MOOSE/Test/10002, MOOSE will construct the full tissue atlas (n=120) based on both PET and CT data
2022-04-06 13:46:34,096 INFO     [run_moose.py:128] Initiating PET/CT segmentation protocols
2022-04-06 13:46:34,097 INFO     [run_moose.py:133] Output folder: /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels
2022-04-06 13:46:34,433 INFO     [inferenceEngine.py:70] CT image to be segmented: /home/kyloren/Documents/Projects/MOOSE/Test/10002/CT/10002_AbdomenRoutine_0_3_0000\.nii\.gz
2022-04-06 13:46:34,434 INFO     [inferenceEngine.py:71] Output directory: /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels
2022-04-06 13:46:34,434 INFO     [inferenceEngine.py:73] Segmenting abdominal organs...
2022-04-06 13:53:59,252 INFO     [inferenceEngine.py:77] Initiating post processing of abdominal organs...
2022-04-06 13:54:02,749 INFO     [inferenceEngine.py:80] - Removing skeleton...replacing skeleton intensity (12) with 0
2022-04-06 13:54:02,749 INFO     [inferenceEngine.py:81] - Replacing lung intensity (13) with 12
2022-04-06 13:54:02,750 INFO     [inferenceEngine.py:82] Abdominal organs segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/Organs_10002_AbdomenRoutine_0_3.nii.gz
2022-04-06 13:54:02,750 INFO     [inferenceEngine.py:84] Segmenting Bones...
2022-04-06 14:05:05,303 INFO     [inferenceEngine.py:92] Bones segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/Bones_10002_AbdomenRoutine_0_3.nii.gz
2022-04-06 14:05:05,303 INFO     [inferenceEngine.py:94] Segmenting skeletal muscle, subcutaneous and visceral fat...
2022-04-06 14:09:36,620 INFO     [inferenceEngine.py:103] Fat-Muscle segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/Fat-Muscle_10002_AbdomenRoutine_0_3.nii.gz
2022-04-06 14:09:36,620 INFO     [inferenceEngine.py:105] Segmenting psoas and assigning the right label intensity...
2022-04-06 14:13:24,888 INFO     [inferenceEngine.py:115] Psoas segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/Psoas_10002_AbdomenRoutine_0_3.nii.gz
2022-04-06 14:13:24,889 INFO     [postprocess.py:46] Post processing of the segmented CT image...
2022-04-06 14:13:24,889 INFO     [postprocess.py:47] - Removing overlays of organs from Bone segmentation
2022-04-06 14:13:31,633 INFO     [postprocess.py:51] - Removing overlays of organs from fat-muscle segmentation
2022-04-06 14:13:38,690 INFO     [postprocess.py:55] - Removing overlays of organs from Psoas segmentation
2022-04-06 14:13:45,494 INFO     [postprocess.py:60] - Removing overlays of Bones from fat-muscle segmentation
2022-04-06 14:13:52,642 INFO     [postprocess.py:64] - Removing overlays of Bones from Psoas segmentation
2022-04-06 14:13:59,476 INFO     [postprocess.py:68] - Removing overlays of Psoas from fat-muscle segmentation
2022-04-06 14:14:06,635 INFO     [postprocess.py:72] Post processing of segmented CT image done
2022-04-06 14:14:06,635 INFO     [inferenceEngine.py:117] Merging all non-cerebral tissues segmented from CT...
2022-04-06 14:14:16,913 INFO     [inferenceEngine.py:120] Non-cerebral tissues segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/MOOSE-Non-cerebral-tissues-CT-10002.nii.gz
2022-04-06 14:14:16,913 INFO     [run_moose.py:137] Aligning PET and CT data using diffeomorphic registration
2022-04-06 14:14:16,914 INFO     [postprocess.py:83] Aligning PET and CT images...
2022-04-06 14:14:16,914 INFO     [greedy.py:59]  
2022-04-06 14:14:16,914 INFO     [greedy.py:64] - Registration type: Affine
2022-04-06 14:14:16,914 INFO     [greedy.py:65] - Reference image: /home/kyloren/Documents/Projects/MOOSE/Test/10002/PT/10002_PET_WB_FDG_0_103\.nii
2022-04-06 14:14:16,915 INFO     [greedy.py:66] - Moving image: /home/kyloren/Documents/Projects/MOOSE/Test/10002/CT/10002_AbdomenRoutine_0_3_0000\.nii\.gz
2022-04-06 14:14:16,915 INFO     [greedy.py:67] - Cost function: NMI
2022-04-06 14:14:16,915 INFO     [greedy.py:68] - Initial alignment: Image centers
2022-04-06 14:14:16,915 INFO     [greedy.py:69] - Multi-resolution level iterations: 100x50x25
2022-04-06 14:14:16,915 INFO     [greedy.py:70] - Transform file generated: affine.mat
2022-04-06 14:14:16,915 INFO     [greedy.py:71]  
2022-04-06 14:15:07,368 INFO     [greedy.py:169] Resampling parameters:
2022-04-06 14:15:07,369 INFO     [greedy.py:170] - Reference image: /home/kyloren/Documents/Projects/MOOSE/Test/10002/PT/10002_PET_WB_FDG_0_103\.nii
2022-04-06 14:15:07,369 INFO     [greedy.py:171] - Moving image: /home/kyloren/Documents/Projects/MOOSE/Test/10002/CT/10002_AbdomenRoutine_0_3_0000\.nii\.gz
2022-04-06 14:15:07,369 INFO     [greedy.py:172] - Resampled moving image: /home/kyloren/Documents/Projects/MOOSE/Test/10002/CT/pet_aligned_10002_AbdomenRoutine_0_3_0000.nii.gz
2022-04-06 14:15:07,369 INFO     [greedy.py:173] - Segmentation: /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/MOOSE-Non-cerebral-tissues-CT-10002.nii.gz
2022-04-06 14:15:07,369 INFO     [greedy.py:174] - Resampled segmentation: /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/pet_aligned_MOOSE-Non-cerebral-tissues-CT-10002.nii.gz
2022-04-06 14:15:07,369 INFO     [greedy.py:175] - Interpolation scheme for resampling: Nearest neighbor for images and segmentations
2022-04-06 14:15:07,369 INFO     [greedy.py:176]  
2022-04-06 14:15:07,369 INFO     [postprocess.py:90] Alignment of PET and CT images done and saved as /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/pet_aligned_MOOSE-Non-cerebral-tissues-CT-10002.nii.gz
2022-04-06 14:15:07,369 INFO     [run_moose.py:143] PET/CT alignment completed
2022-04-06 14:15:07,370 INFO     [run_moose.py:145] Calculating SUV parameters for SUV extraction...
2022-04-06 14:15:07,378 INFO     [imageIO.py:163] CT != PT
2022-04-06 14:15:07,383 INFO     [imageIO.py:159] Found PT images in /home/kyloren/Documents/Projects/MOOSE/Test/10002/PET_WB_CORRECTED_1.2.752.37.47.345051852996.20220302.28966.5.426167
2022-04-06 14:15:07,388 INFO     [run_moose.py:151] Converting PET image to SUV Image...
2022-04-06 14:15:10,475 INFO     [run_moose.py:156] Brain found in field-of-view of PET/CT data...
2022-04-06 14:15:10,475 INFO     [run_moose.py:158] Cropping brain from PET image using the aligned CT brain mask
2022-04-06 14:15:10,608 INFO     [run_moose.py:165] Brain region cropped from PET...
2022-04-06 14:15:10,608 INFO     [run_moose.py:167] Segmenting 83 tissue types of the Hammersmith atlas from the cropped PET brain
2022-04-06 14:15:10,608 INFO     [inferenceEngine.py:132] PT image to be segmented: /home/kyloren/Documents/Projects/MOOSE/Test/10002/temp/cropped-brain-from-PET_0000.nii.gz
2022-04-06 14:15:10,608 INFO     [inferenceEngine.py:133] Output directory: /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels
2022-04-06 14:15:10,608 INFO     [inferenceEngine.py:134] Segmenting brain...
2022-04-06 14:15:24,566 INFO     [inferenceEngine.py:144] Brain segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/Brain_cropped-brain-from-PET.nii.gz
2022-04-06 14:15:24,566 INFO     [run_moose.py:169] 83 tissue types segmented from the cropped PET brain
2022-04-06 14:15:24,566 INFO     [run_moose.py:171] Merging PET and CT segmentations to construct the entire atlas...
2022-04-06 14:15:24,566 INFO     [postprocess.py:117] Removing whole-brain segmentation from CT segmentation to merge the 83 subregions from PET
2022-04-06 14:15:25,395 INFO     [postprocess.py:122] Reslicing (to identity) PET segmentation, segmentations will be in pet voxel space...
2022-04-06 14:15:25,888 INFO     [postprocess.py:32] Performing postprocessing of the PT segmentation results
2022-04-06 14:15:25,888 INFO     [postprocess.py:33] Removing the overlays of PT brain segmentation results from the PT aligned non-cerebral CT segmentations
2022-04-06 14:15:26,710 INFO     [postprocess.py:126] Merging PET and CT segmentations...
2022-04-06 14:15:27,407 INFO     [postprocess.py:128] Merging PET and CT segmentations done
2022-04-06 14:15:27,407 INFO     [run_moose.py:179] PET/CT segmentation completed and unified atlas constructed and stored in /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/MOOSE-unified-PET-CT-atlas.nii.gz
2022-04-06 14:15:27,408 INFO     [run_moose.py:183] Extracting SUV values from the PET image using the MOOSE atlas...
2022-04-06 14:15:27,816 INFO     [run_moose.py:188] SUV values extracted from the PET image using the MOOSE atlas...
2022-04-06 14:15:27,817 INFO     [run_moose.py:189] SUV values stored in /home/kyloren/Documents/Projects/MOOSE/Test/10002/10002-SUV-values.csv
2022-04-06 14:15:27,817 INFO     [errorAnalysis.py:145] Performing error analysis in similarity space for /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/MOOSE-Non-cerebral-tissues-CT-10002.nii.gz
2022-04-06 14:15:27,817 INFO     [errorAnalysis.py:38] Splitting the multi-label image: /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/MOOSE-Non-cerebral-tissues-CT-10002.nii.gz into individual label images
2022-04-06 14:15:27,817 INFO     [errorAnalysis.py:40] Split label images will be assigned to their label names and stored in: /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/sim_space/similarity-space
2022-04-06 14:15:27,817 INFO     [errorAnalysis.py:42] Executing the splitting using multiple threads: 64
2022-04-06 14:15:30,827 INFO     [errorAnalysis.py:64] Adrenal-glands.nii.gz will be scaled with the label: 1
2022-04-06 14:15:30,827 INFO     [errorAnalysis.py:64] Aorta.nii.gz will be scaled with the label: 2
2022-04-06 14:15:30,827 INFO     [errorAnalysis.py:64] Brain.nii.gz will be scaled with the label: 4
2022-04-06 14:15:30,828 INFO     [errorAnalysis.py:64] Bladder.nii.gz will be scaled with the label: 3
2022-04-06 14:15:30,829 INFO     [errorAnalysis.py:64] Heart.nii.gz will be scaled with the label: 5
2022-04-06 14:15:30,830 INFO     [errorAnalysis.py:64] Kidneys.nii.gz will be scaled with the label: 6
2022-04-06 14:15:30,831 INFO     [errorAnalysis.py:64] Liver.nii.gz will be scaled with the label: 7
2022-04-06 14:15:30,832 INFO     [errorAnalysis.py:64] Pancreas.nii.gz will be scaled with the label: 8
2022-04-06 14:15:30,833 INFO     [errorAnalysis.py:64] Spleen.nii.gz will be scaled with the label: 9
2022-04-06 14:15:30,834 INFO     [errorAnalysis.py:64] Thyroid.nii.gz will be scaled with the label: 10
2022-04-06 14:15:30,835 INFO     [errorAnalysis.py:64] Inferior-vena-cava.nii.gz will be scaled with the label: 11
2022-04-06 14:15:30,835 INFO     [errorAnalysis.py:64] Lung.nii.gz will be scaled with the label: 12
2022-04-06 14:15:30,836 INFO     [errorAnalysis.py:64] Clavicle.nii.gz will be scaled with the label: 14
2022-04-06 14:15:30,838 INFO     [errorAnalysis.py:64] Femur.nii.gz will be scaled with the label: 15
2022-04-06 14:15:30,839 INFO     [errorAnalysis.py:64] Humerus.nii.gz will be scaled with the label: 17
2022-04-06 14:15:30,839 INFO     [errorAnalysis.py:64] Pelvis.nii.gz will be scaled with the label: 21
2022-04-06 14:15:30,840 INFO     [errorAnalysis.py:64] Ribcage.nii.gz will be scaled with the label: 24
2022-04-06 14:15:30,841 INFO     [errorAnalysis.py:64] Scapula.nii.gz will be scaled with the label: 25
2022-04-06 14:15:30,842 INFO     [errorAnalysis.py:64] Skull.nii.gz will be scaled with the label: 26
2022-04-06 14:15:30,843 INFO     [errorAnalysis.py:64] Spine.nii.gz will be scaled with the label: 27
2022-04-06 14:15:30,845 INFO     [errorAnalysis.py:64] Skeletal-muscle.nii.gz will be scaled with the label: 33
2022-04-06 14:15:30,845 INFO     [errorAnalysis.py:64] Sternum.nii.gz will be scaled with the label: 28
2022-04-06 14:15:30,846 INFO     [errorAnalysis.py:64] Subcutaneous-fat.nii.gz will be scaled with the label: 34
2022-04-06 14:15:30,847 INFO     [errorAnalysis.py:64] Torso-fat.nii.gz will be scaled with the label: 35
2022-04-06 14:15:30,848 INFO     [errorAnalysis.py:64] Psoas.nii.gz will be scaled with the label: 36
2022-04-06 14:15:40,438 INFO     [errorAnalysis.py:81] Physically splitting dual organs images from /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/sim_space/similarity-space into left and right parts
2022-04-06 14:15:40,438 INFO     [errorAnalysis.py:82] The output will be stored in /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/sim_space/similarity-space and the original image will be deleted
2022-04-06 14:15:40,438 INFO     [errorAnalysis.py:83] Executing the physical splitting using multiple threads: 64
2022-04-06 14:15:54,548 INFO     [errorAnalysis.py:113] Assigning unique intensity labels to the split masks stored in /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/sim_space/similarity-space based on predefined constants: {1: 'R-Adrenal-glands', 2: 'L-Adrenal-glands', 3: 'Aorta', 4: 'Brain', 5: 'Bladder', 6: 'Heart', 7: 'R-Kidneys', 8: 'L-Kidneys', 9: 'Liver', 10: 'Pancreas', 11: 'Spleen', 12: 'Thyroid', 13: 'Inferior-vena-cava', 14: 'R-Lung', 15: 'L-Lung', 16: 'R-Carpal', 17: 'L-Carpal', 18: 'R-Clavicle', 19: 'L-Clavicle', 20: 'R-Femur', 21: 'L-Femur', 22: 'R-Fibula', 23: 'L-Fibula', 24: 'R-Humerus', 25: 'L-Humerus', 26: 'R-Metacarpal', 27: 'L-Metacarpal', 28: 'R-Metatarsal', 29: 'L-Metatarsal', 30: 'R-Patella', 31: 'L-Patella', 32: 'Pelvis', 33: 'R-Fingers', 34: 'L-Fingers', 35: 'R-Radius', 36: 'L-Radius', 37: 'Ribcage', 38: 'R-Scapula', 39: 'L-Scapula', 40: 'Skull', 41: 'Spine', 42: 'Sternum', 43: 'R-Tarsal', 44: 'L-Tarsal', 45: 'R-Tibia', 46: 'L-Tibia', 47: 'R-Toes', 48: 'L-Toes', 49: 'R-Ulna', 50: 'L-Ulna', 51: 'Skeletal-muscle', 52: 'Subcutaneous-fat', 53: 'Torso-fat', 54: 'R-Psoas', 55: 'L-Psoas', 56: 'R-Hippocampus', 57: 'L-Hippocampus', 58: 'R-Amygdala', 59: 'L-Amygdala', 60: 'R-Anterior-temporal-lobe-medial-part', 61: 'L-Anterior-temporal-lobe-medial-part', 62: 'R-Anterior-temporal-lobe-lateral-part', 63: 'L-Anterior-temporal-lobe-lateral-part', 64: 'R-Parahippocampal-and-ambient-gyri', 65: 'L-Parahippocampal-and-ambient-gyri', 66: 'R-Superior-temporal-gyrus-posterior-part', 67: 'L-Superior-temporal-gyrus-posterior-part', 68: 'R-Middle-and-inferior-temporal-gyrus', 69: 'L-Middle-and-inferior-temporal-gyrus', 70: 'R-Fusiform-gyrus', 71: 'L-Fusiform-gyrus', 72: 'R-Cerebellum', 73: 'L-Cerebellum', 74: 'Brainstem', 75: 'L-Insula', 76: 'R-Insula', 77: 'L-Lateral-remainder-of-occipital-lobe', 78: 'R-Lateral-remainder-of-occipital-lobe', 79: 'L-Cingulate-gyrus-gyrus-cinguli-anterior-part', 80: 'R-Cingulate-gyrus-gyrus-cinguli-anterior-part', 81: 'L-Cingulate-gyrus-gyrus-cinguli-posterior-part', 82: 'R-Cingulate-gyrus-gyrus-cinguli-posterior-part', 83: 'L-Middle-frontal-gyrus', 84: 'R-Middle-frontal-gyrus', 85: 'L-Posterior-temporal-lobe', 86: 'R-Posterior-temporal-lobe', 87: 'L-Inferiolateral-remainder-of-parietal-lobe', 88: 'R-Inferiolateral-remainder-of-parietal-lobe', 89: 'L-Caudate-nucleus', 90: 'R-Caudate-nucleus', 91: 'L-Nucleus-accumbens', 92: 'R-Nucleus-accumbens', 93: 'L-Putamen', 94: 'R-Putamen', 95: 'L-Thalamus', 96: 'R-Thalamus', 97: 'L-Pallidum', 98: 'R-Pallidum', 99: 'Corpus-callosum', 100: 'R-Lateral-ventricle-excluding-temporal-horn', 101: 'L-Lateral-ventricle-excluding-temporal-horn', 102: 'R-Lateral-ventricle-temporal-horn', 103: 'L-Lateral-ventricle-temporal-horn', 104: 'Third-ventricle', 105: 'L-Precentral-gyrus', 106: 'R-Precentral-gyrus', 107: 'L-Straight-gyrus', 108: 'R-Straight-gyrus', 109: 'L-Anterior-orbital-gyrus', 110: 'R-Anterior-orbital-gyrus', 111: 'L-Inferior-frontal-gyrus', 112: 'R-Inferior-frontal-gyrus', 113: 'L-Superior-frontal-gyrus', 114: 'R-Superior-frontal-gyrus', 115: 'L-Postcentral-gyrus', 116: 'R-Postcentral-gyrus', 117: 'L-Superior-parietal-gyrus', 118: 'R-Superior-parietal-gyrus', 119: 'L-Lingual-gyrus', 120: 'R-Lingual-gyrus', 121: 'L-Cuneus', 122: 'R-Cuneus', 123: 'L-Medial-orbital-gyrus', 124: 'R-Medial-orbital-gyrus', 125: 'L-Lateral-orbital-gyrus', 126: 'R-Lateral-orbital-gyrus', 127: 'L-Posterior-orbital-gyrus', 128: 'R-Posterior-orbital-gyrus', 129: 'L-Substantia-nigra', 130: 'R-Substantia-nigra', 131: 'L-Subgenual-frontal-cortex', 132: 'R-Subgenual-frontal-cortex', 133: 'L-Subcallosal-area', 134: 'R-Subcallosal-area', 135: 'L-Pre-subgenual-frontal-cortex', 136: 'R-Pre-subgenual-frontal-cortex', 137: 'L-Superior-temporal-gyrus-anterior-part', 138: 'R-Superior-temporal-gyrus-anterior-part'}
2022-04-06 14:16:01,050 INFO     [errorAnalysis.py:149] Summing the split masks to get the final mask and store it in /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/sim_space/similarity-space
2022-04-06 14:17:10,713 INFO     [errorAnalysis.py:152] Measuring shape parameters for /home/kyloren/Documents/Projects/MOOSE/Test/10002/labels/sim_space/similarity-space/MOOSE-Split-unified-PET-CT-atlas.nii.gz
2022-04-06 14:17:12,850 INFO     [run_moose.py:219] Initiating cleanup of MOOSE output...
2022-04-06 14:17:12,851 INFO     [run_moose.py:224] MOOSE output cleaned up...and can be found in /home/kyloren/Documents/Projects/MOOSE/Test/10002/MOOSE-10002
2022-04-06 14:17:12,851 INFO     [run_moose.py:71] :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2022-04-06 14:17:12,851 INFO     [run_moose.py:72] - Working folder: /home/kyloren/Documents/Projects/MOOSE/Test/10003
2022-04-06 14:17:12,851 INFO     [run_moose.py:74] - Processing subject:  10003
2022-04-06 14:17:12,851 INFO     [run_moose.py:76] - Number of folders in subject 10003: 2
2022-04-06 14:17:12,851 INFO     [run_moose.py:77] - Folder names: ['/home/kyloren/Documents/Projects/MOOSE/Test/10003/AC_CT_1.2.752.37.47.345051852996.20220311.1441.5.430761', '/home/kyloren/Documents/Projects/MOOSE/Test/10003/PET_WB_CORRECTED_1.2.752.37.47.345051852996.20220311.1441.5.430763']
2022-04-06 14:17:12,851 INFO     [run_moose.py:78] :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
2022-04-06 14:17:12,851 INFO     [run_moose.py:79]  
2022-04-06 14:17:12,851 INFO     [imageIO.py:95] Converting DICOM images in /home/kyloren/Documents/Projects/MOOSE/Test/10003 to NIFTI
2022-04-06 14:17:13,495 INFO     [imageIO.py:100] Conversion from DICOM to NIFTI done
2022-04-06 14:17:13,497 INFO     [run_moose.py:87] Looking for modality type and organising the files accordingly
2022-04-06 14:17:13,497 INFO     [run_moose.py:122] Both PET and CT data found in folder /home/kyloren/Documents/Projects/MOOSE/Test/10003, MOOSE will construct the full tissue atlas (n=120) based on both PET and CT data
2022-04-06 14:17:13,498 INFO     [run_moose.py:128] Initiating PET/CT segmentation protocols
2022-04-06 14:17:13,498 INFO     [run_moose.py:133] Output folder: /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels
2022-04-06 14:17:13,882 INFO     [inferenceEngine.py:70] CT image to be segmented: /home/kyloren/Documents/Projects/MOOSE/Test/10003/CT/10003_PETCT_AC_FDG_20080422145617_2_0000\.nii\.gz
2022-04-06 14:17:13,882 INFO     [inferenceEngine.py:71] Output directory: /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels
2022-04-06 14:17:13,883 INFO     [inferenceEngine.py:73] Segmenting abdominal organs...
2022-04-06 14:25:10,446 INFO     [inferenceEngine.py:77] Initiating post processing of abdominal organs...
2022-04-06 14:25:14,396 INFO     [inferenceEngine.py:80] - Removing skeleton...replacing skeleton intensity (12) with 0
2022-04-06 14:25:14,396 INFO     [inferenceEngine.py:81] - Replacing lung intensity (13) with 12
2022-04-06 14:25:14,397 INFO     [inferenceEngine.py:82] Abdominal organs segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/Organs_10003_PETCT_AC_FDG_20080422145617_2.nii.gz
2022-04-06 14:25:14,397 INFO     [inferenceEngine.py:84] Segmenting Bones...
2022-04-06 14:37:31,989 INFO     [inferenceEngine.py:92] Bones segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/Bones_10003_PETCT_AC_FDG_20080422145617_2.nii.gz
2022-04-06 14:37:31,989 INFO     [inferenceEngine.py:94] Segmenting skeletal muscle, subcutaneous and visceral fat...
2022-04-06 14:42:08,480 INFO     [inferenceEngine.py:103] Fat-Muscle segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/Fat-Muscle_10003_PETCT_AC_FDG_20080422145617_2.nii.gz
2022-04-06 14:42:08,481 INFO     [inferenceEngine.py:105] Segmenting psoas and assigning the right label intensity...
2022-04-06 14:46:06,129 INFO     [inferenceEngine.py:115] Psoas segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/Psoas_10003_PETCT_AC_FDG_20080422145617_2.nii.gz
2022-04-06 14:46:06,129 INFO     [postprocess.py:46] Post processing of the segmented CT image...
2022-04-06 14:46:06,129 INFO     [postprocess.py:47] - Removing overlays of organs from Bone segmentation
2022-04-06 14:46:13,852 INFO     [postprocess.py:51] - Removing overlays of organs from fat-muscle segmentation
2022-04-06 14:46:21,838 INFO     [postprocess.py:55] - Removing overlays of organs from Psoas segmentation
2022-04-06 14:46:29,526 INFO     [postprocess.py:60] - Removing overlays of Bones from fat-muscle segmentation
2022-04-06 14:46:37,471 INFO     [postprocess.py:64] - Removing overlays of Bones from Psoas segmentation
2022-04-06 14:46:45,161 INFO     [postprocess.py:68] - Removing overlays of Psoas from fat-muscle segmentation
2022-04-06 14:46:53,145 INFO     [postprocess.py:72] Post processing of segmented CT image done
2022-04-06 14:46:53,146 INFO     [inferenceEngine.py:117] Merging all non-cerebral tissues segmented from CT...
2022-04-06 14:47:04,634 INFO     [inferenceEngine.py:120] Non-cerebral tissues segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/MOOSE-Non-cerebral-tissues-CT-10003.nii.gz
2022-04-06 14:47:04,634 INFO     [run_moose.py:137] Aligning PET and CT data using diffeomorphic registration
2022-04-06 14:47:04,635 INFO     [postprocess.py:83] Aligning PET and CT images...
2022-04-06 14:47:04,635 INFO     [greedy.py:59]  
2022-04-06 14:47:04,635 INFO     [greedy.py:64] - Registration type: Affine
2022-04-06 14:47:04,635 INFO     [greedy.py:65] - Reference image: /home/kyloren/Documents/Projects/MOOSE/Test/10003/PT/10003_PET_WB_FDG_20080422145617_102\.nii
2022-04-06 14:47:04,635 INFO     [greedy.py:66] - Moving image: /home/kyloren/Documents/Projects/MOOSE/Test/10003/CT/10003_PETCT_AC_FDG_20080422145617_2_0000\.nii\.gz
2022-04-06 14:47:04,635 INFO     [greedy.py:67] - Cost function: NMI
2022-04-06 14:47:04,635 INFO     [greedy.py:68] - Initial alignment: Image centers
2022-04-06 14:47:04,636 INFO     [greedy.py:69] - Multi-resolution level iterations: 100x50x25
2022-04-06 14:47:04,636 INFO     [greedy.py:70] - Transform file generated: affine.mat
2022-04-06 14:47:04,636 INFO     [greedy.py:71]  
2022-04-06 14:48:02,288 INFO     [greedy.py:169] Resampling parameters:
2022-04-06 14:48:02,288 INFO     [greedy.py:170] - Reference image: /home/kyloren/Documents/Projects/MOOSE/Test/10003/PT/10003_PET_WB_FDG_20080422145617_102\.nii
2022-04-06 14:48:02,288 INFO     [greedy.py:171] - Moving image: /home/kyloren/Documents/Projects/MOOSE/Test/10003/CT/10003_PETCT_AC_FDG_20080422145617_2_0000\.nii\.gz
2022-04-06 14:48:02,288 INFO     [greedy.py:172] - Resampled moving image: /home/kyloren/Documents/Projects/MOOSE/Test/10003/CT/pet_aligned_10003_PETCT_AC_FDG_20080422145617_2_0000.nii.gz
2022-04-06 14:48:02,288 INFO     [greedy.py:173] - Segmentation: /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/MOOSE-Non-cerebral-tissues-CT-10003.nii.gz
2022-04-06 14:48:02,288 INFO     [greedy.py:174] - Resampled segmentation: /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/pet_aligned_MOOSE-Non-cerebral-tissues-CT-10003.nii.gz
2022-04-06 14:48:02,289 INFO     [greedy.py:175] - Interpolation scheme for resampling: Nearest neighbor for images and segmentations
2022-04-06 14:48:02,289 INFO     [greedy.py:176]  
2022-04-06 14:48:02,289 INFO     [postprocess.py:90] Alignment of PET and CT images done and saved as /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/pet_aligned_MOOSE-Non-cerebral-tissues-CT-10003.nii.gz
2022-04-06 14:48:02,289 INFO     [run_moose.py:143] PET/CT alignment completed
2022-04-06 14:48:02,289 INFO     [run_moose.py:145] Calculating SUV parameters for SUV extraction...
2022-04-06 14:48:02,296 INFO     [imageIO.py:163] CT != PT
2022-04-06 14:48:02,301 INFO     [imageIO.py:159] Found PT images in /home/kyloren/Documents/Projects/MOOSE/Test/10003/PET_WB_CORRECTED_1.2.752.37.47.345051852996.20220311.1441.5.430763
2022-04-06 14:48:02,304 INFO     [run_moose.py:151] Converting PET image to SUV Image...
2022-04-06 14:48:05,552 INFO     [run_moose.py:156] Brain found in field-of-view of PET/CT data...
2022-04-06 14:48:05,553 INFO     [run_moose.py:158] Cropping brain from PET image using the aligned CT brain mask
2022-04-06 14:48:05,716 INFO     [run_moose.py:165] Brain region cropped from PET...
2022-04-06 14:48:05,716 INFO     [run_moose.py:167] Segmenting 83 tissue types of the Hammersmith atlas from the cropped PET brain
2022-04-06 14:48:05,716 INFO     [inferenceEngine.py:132] PT image to be segmented: /home/kyloren/Documents/Projects/MOOSE/Test/10003/temp/cropped-brain-from-PET_0000.nii.gz
2022-04-06 14:48:05,716 INFO     [inferenceEngine.py:133] Output directory: /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels
2022-04-06 14:48:05,716 INFO     [inferenceEngine.py:134] Segmenting brain...
2022-04-06 14:48:20,021 INFO     [inferenceEngine.py:144] Brain segmented and saved in /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/Brain_cropped-brain-from-PET.nii.gz
2022-04-06 14:48:20,021 INFO     [run_moose.py:169] 83 tissue types segmented from the cropped PET brain
2022-04-06 14:48:20,021 INFO     [run_moose.py:171] Merging PET and CT segmentations to construct the entire atlas...
2022-04-06 14:48:20,022 INFO     [postprocess.py:117] Removing whole-brain segmentation from CT segmentation to merge the 83 subregions from PET
2022-04-06 14:48:20,926 INFO     [postprocess.py:122] Reslicing (to identity) PET segmentation, segmentations will be in pet voxel space...
2022-04-06 14:48:21,471 INFO     [postprocess.py:32] Performing postprocessing of the PT segmentation results
2022-04-06 14:48:21,472 INFO     [postprocess.py:33] Removing the overlays of PT brain segmentation results from the PT aligned non-cerebral CT segmentations
2022-04-06 14:48:22,350 INFO     [postprocess.py:126] Merging PET and CT segmentations...
2022-04-06 14:48:23,120 INFO     [postprocess.py:128] Merging PET and CT segmentations done
2022-04-06 14:48:23,121 INFO     [run_moose.py:179] PET/CT segmentation completed and unified atlas constructed and stored in /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/MOOSE-unified-PET-CT-atlas.nii.gz
2022-04-06 14:48:23,121 INFO     [run_moose.py:183] Extracting SUV values from the PET image using the MOOSE atlas...
2022-04-06 14:48:23,584 INFO     [run_moose.py:188] SUV values extracted from the PET image using the MOOSE atlas...
2022-04-06 14:48:23,585 INFO     [run_moose.py:189] SUV values stored in /home/kyloren/Documents/Projects/MOOSE/Test/10003/10003-SUV-values.csv
2022-04-06 14:48:23,585 INFO     [errorAnalysis.py:145] Performing error analysis in similarity space for /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/MOOSE-Non-cerebral-tissues-CT-10003.nii.gz
2022-04-06 14:48:23,585 INFO     [errorAnalysis.py:38] Splitting the multi-label image: /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/MOOSE-Non-cerebral-tissues-CT-10003.nii.gz into individual label images
2022-04-06 14:48:23,585 INFO     [errorAnalysis.py:40] Split label images will be assigned to their label names and stored in: /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/sim_space/similarity-space
2022-04-06 14:48:23,585 INFO     [errorAnalysis.py:42] Executing the splitting using multiple threads: 64
2022-04-06 14:48:27,623 INFO     [errorAnalysis.py:64] Aorta.nii.gz will be scaled with the label: 2
2022-04-06 14:48:27,623 INFO     [errorAnalysis.py:64] Adrenal-glands.nii.gz will be scaled with the label: 1
2022-04-06 14:48:27,623 INFO     [errorAnalysis.py:64] Brain.nii.gz will be scaled with the label: 4
2022-04-06 14:48:27,623 INFO     [errorAnalysis.py:64] Bladder.nii.gz will be scaled with the label: 3
2022-04-06 14:48:27,624 INFO     [errorAnalysis.py:64] Heart.nii.gz will be scaled with the label: 5
2022-04-06 14:48:27,625 INFO     [errorAnalysis.py:64] Liver.nii.gz will be scaled with the label: 7
2022-04-06 14:48:27,625 INFO     [errorAnalysis.py:64] Kidneys.nii.gz will be scaled with the label: 6
2022-04-06 14:48:27,627 INFO     [errorAnalysis.py:64] Pancreas.nii.gz will be scaled with the label: 8
2022-04-06 14:48:27,628 INFO     [errorAnalysis.py:64] Spleen.nii.gz will be scaled with the label: 9
2022-04-06 14:48:27,629 INFO     [errorAnalysis.py:64] Thyroid.nii.gz will be scaled with the label: 10
2022-04-06 14:48:27,630 INFO     [errorAnalysis.py:64] Inferior-vena-cava.nii.gz will be scaled with the label: 11
2022-04-06 14:48:27,630 INFO     [errorAnalysis.py:64] Femur.nii.gz will be scaled with the label: 15
2022-04-06 14:48:27,630 INFO     [errorAnalysis.py:64] Lung.nii.gz will be scaled with the label: 12
2022-04-06 14:48:27,630 INFO     [errorAnalysis.py:64] Clavicle.nii.gz will be scaled with the label: 14
2022-04-06 14:48:27,631 INFO     [errorAnalysis.py:64] Pelvis.nii.gz will be scaled with the label: 21
2022-04-06 14:48:27,632 INFO     [errorAnalysis.py:64] Humerus.nii.gz will be scaled with the label: 17
2022-04-06 14:48:27,632 INFO     [errorAnalysis.py:64] Skull.nii.gz will be scaled with the label: 26
2022-04-06 14:48:27,633 INFO     [errorAnalysis.py:64] Ribcage.nii.gz will be scaled with the label: 24
2022-04-06 14:48:27,633 INFO     [errorAnalysis.py:64] Scapula.nii.gz will be scaled with the label: 25
2022-04-06 14:48:27,634 INFO     [errorAnalysis.py:64] Spine.nii.gz will be scaled with the label: 27
2022-04-06 14:48:27,636 INFO     [errorAnalysis.py:64] Sternum.nii.gz will be scaled with the label: 28
2022-04-06 14:48:27,636 INFO     [errorAnalysis.py:64] Skeletal-muscle.nii.gz will be scaled with the label: 33
2022-04-06 14:48:27,636 INFO     [errorAnalysis.py:64] Subcutaneous-fat.nii.gz will be scaled with the label: 34
2022-04-06 14:48:27,638 INFO     [errorAnalysis.py:64] Torso-fat.nii.gz will be scaled with the label: 35
2022-04-06 14:48:27,640 INFO     [errorAnalysis.py:64] Psoas.nii.gz will be scaled with the label: 36
2022-04-06 14:48:39,060 INFO     [errorAnalysis.py:81] Physically splitting dual organs images from /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/sim_space/similarity-space into left and right parts
2022-04-06 14:48:39,060 INFO     [errorAnalysis.py:82] The output will be stored in /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/sim_space/similarity-space and the original image will be deleted
2022-04-06 14:48:39,060 INFO     [errorAnalysis.py:83] Executing the physical splitting using multiple threads: 64
2022-04-06 14:48:56,499 INFO     [errorAnalysis.py:113] Assigning unique intensity labels to the split masks stored in /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/sim_space/similarity-space based on predefined constants: {1: 'R-Adrenal-glands', 2: 'L-Adrenal-glands', 3: 'Aorta', 4: 'Brain', 5: 'Bladder', 6: 'Heart', 7: 'R-Kidneys', 8: 'L-Kidneys', 9: 'Liver', 10: 'Pancreas', 11: 'Spleen', 12: 'Thyroid', 13: 'Inferior-vena-cava', 14: 'R-Lung', 15: 'L-Lung', 16: 'R-Carpal', 17: 'L-Carpal', 18: 'R-Clavicle', 19: 'L-Clavicle', 20: 'R-Femur', 21: 'L-Femur', 22: 'R-Fibula', 23: 'L-Fibula', 24: 'R-Humerus', 25: 'L-Humerus', 26: 'R-Metacarpal', 27: 'L-Metacarpal', 28: 'R-Metatarsal', 29: 'L-Metatarsal', 30: 'R-Patella', 31: 'L-Patella', 32: 'Pelvis', 33: 'R-Fingers', 34: 'L-Fingers', 35: 'R-Radius', 36: 'L-Radius', 37: 'Ribcage', 38: 'R-Scapula', 39: 'L-Scapula', 40: 'Skull', 41: 'Spine', 42: 'Sternum', 43: 'R-Tarsal', 44: 'L-Tarsal', 45: 'R-Tibia', 46: 'L-Tibia', 47: 'R-Toes', 48: 'L-Toes', 49: 'R-Ulna', 50: 'L-Ulna', 51: 'Skeletal-muscle', 52: 'Subcutaneous-fat', 53: 'Torso-fat', 54: 'R-Psoas', 55: 'L-Psoas', 56: 'R-Hippocampus', 57: 'L-Hippocampus', 58: 'R-Amygdala', 59: 'L-Amygdala', 60: 'R-Anterior-temporal-lobe-medial-part', 61: 'L-Anterior-temporal-lobe-medial-part', 62: 'R-Anterior-temporal-lobe-lateral-part', 63: 'L-Anterior-temporal-lobe-lateral-part', 64: 'R-Parahippocampal-and-ambient-gyri', 65: 'L-Parahippocampal-and-ambient-gyri', 66: 'R-Superior-temporal-gyrus-posterior-part', 67: 'L-Superior-temporal-gyrus-posterior-part', 68: 'R-Middle-and-inferior-temporal-gyrus', 69: 'L-Middle-and-inferior-temporal-gyrus', 70: 'R-Fusiform-gyrus', 71: 'L-Fusiform-gyrus', 72: 'R-Cerebellum', 73: 'L-Cerebellum', 74: 'Brainstem', 75: 'L-Insula', 76: 'R-Insula', 77: 'L-Lateral-remainder-of-occipital-lobe', 78: 'R-Lateral-remainder-of-occipital-lobe', 79: 'L-Cingulate-gyrus-gyrus-cinguli-anterior-part', 80: 'R-Cingulate-gyrus-gyrus-cinguli-anterior-part', 81: 'L-Cingulate-gyrus-gyrus-cinguli-posterior-part', 82: 'R-Cingulate-gyrus-gyrus-cinguli-posterior-part', 83: 'L-Middle-frontal-gyrus', 84: 'R-Middle-frontal-gyrus', 85: 'L-Posterior-temporal-lobe', 86: 'R-Posterior-temporal-lobe', 87: 'L-Inferiolateral-remainder-of-parietal-lobe', 88: 'R-Inferiolateral-remainder-of-parietal-lobe', 89: 'L-Caudate-nucleus', 90: 'R-Caudate-nucleus', 91: 'L-Nucleus-accumbens', 92: 'R-Nucleus-accumbens', 93: 'L-Putamen', 94: 'R-Putamen', 95: 'L-Thalamus', 96: 'R-Thalamus', 97: 'L-Pallidum', 98: 'R-Pallidum', 99: 'Corpus-callosum', 100: 'R-Lateral-ventricle-excluding-temporal-horn', 101: 'L-Lateral-ventricle-excluding-temporal-horn', 102: 'R-Lateral-ventricle-temporal-horn', 103: 'L-Lateral-ventricle-temporal-horn', 104: 'Third-ventricle', 105: 'L-Precentral-gyrus', 106: 'R-Precentral-gyrus', 107: 'L-Straight-gyrus', 108: 'R-Straight-gyrus', 109: 'L-Anterior-orbital-gyrus', 110: 'R-Anterior-orbital-gyrus', 111: 'L-Inferior-frontal-gyrus', 112: 'R-Inferior-frontal-gyrus', 113: 'L-Superior-frontal-gyrus', 114: 'R-Superior-frontal-gyrus', 115: 'L-Postcentral-gyrus', 116: 'R-Postcentral-gyrus', 117: 'L-Superior-parietal-gyrus', 118: 'R-Superior-parietal-gyrus', 119: 'L-Lingual-gyrus', 120: 'R-Lingual-gyrus', 121: 'L-Cuneus', 122: 'R-Cuneus', 123: 'L-Medial-orbital-gyrus', 124: 'R-Medial-orbital-gyrus', 125: 'L-Lateral-orbital-gyrus', 126: 'R-Lateral-orbital-gyrus', 127: 'L-Posterior-orbital-gyrus', 128: 'R-Posterior-orbital-gyrus', 129: 'L-Substantia-nigra', 130: 'R-Substantia-nigra', 131: 'L-Subgenual-frontal-cortex', 132: 'R-Subgenual-frontal-cortex', 133: 'L-Subcallosal-area', 134: 'R-Subcallosal-area', 135: 'L-Pre-subgenual-frontal-cortex', 136: 'R-Pre-subgenual-frontal-cortex', 137: 'L-Superior-temporal-gyrus-anterior-part', 138: 'R-Superior-temporal-gyrus-anterior-part'}
2022-04-06 14:49:04,547 INFO     [errorAnalysis.py:149] Summing the split masks to get the final mask and store it in /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/sim_space/similarity-space
2022-04-06 14:50:23,207 INFO     [errorAnalysis.py:152] Measuring shape parameters for /home/kyloren/Documents/Projects/MOOSE/Test/10003/labels/sim_space/similarity-space/MOOSE-Split-unified-PET-CT-atlas.nii.gz
2022-04-06 14:50:25,542 INFO     [run_moose.py:219] Initiating cleanup of MOOSE output...
2022-04-06 14:50:25,543 INFO     [run_moose.py:224] MOOSE output cleaned up...and can be found in /home/kyloren/Documents/Projects/MOOSE/Test/10003/MOOSE-10003
2022-04-06 14:50:25,543 INFO     [run_moose.py:226]  
2022-04-06 14:50:25,543 INFO     [run_moose.py:227] Total time taken for MOOSE processing: 63.87 minutes
2022-04-06 14:50:25,543 INFO     [run_moose.py:228]  
